<!DOCTYPE html>
<!-- Deploy: 2024-04-29 19:20 CST -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Merit - Teacher and Leader Support Chat for EL Education Language Arts Curriculum">
    <meta name="theme-color" content="#c6123f">
    <meta name="api-config" content='{
        "apiEndpoint": "https://3ba2utz7y2.execute-api.us-east-2.amazonaws.com/dev",
        "fallbackEndpoint": "https://29wtfiieig.execute-api.us-east-2.amazonaws.com/prod",
        "apiKey": "0z6mNoPYRz5Z2rzU9FdJc2FFT4onoEOf1gxWUGL1",
        "projectId": "proj_V4lrL1OSfydWCFW0zjgwrFRT",
        "orgId": "recdg5Hlm3VVaBA2u",
        "assistantId": "asst_QoAA395ibbyMImFJERbG2hKT",
        "schemaVersion": "04102025.B01",
        "buildId": "merit-20250423-1349"
    }'>
    <title>Merit | Recursive Learning</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/images/client-elpl-favicon.ico">
    
    <!-- Client level styles -->
    <link rel="stylesheet" href="/rl-restapi-lambda/clients/elpl/assets/css/client-elpl-variables.css">
    <link rel="stylesheet" href="/rl-restapi-lambda/clients/elpl/assets/css/client-elpl.css">
    
    <!-- Project level styles -->
    <link rel="stylesheet" href="assets/css/client-merit-chat.css">
    <link rel="stylesheet" href="assets/css/client-merit.css">
    
    <!-- Environment Configuration -->
    <script>
        // Get API config from meta tag
        const apiConfig = JSON.parse(document.querySelector('meta[name="api-config"]').content);
        
        // Build timestamp is static to match deployment
        const BUILD_TIMESTAMP = '20250423T134900Z';
        
        window.env = {
            // API Configuration
            RL_API_GATEWAY_ENDPOINT: apiConfig.apiEndpoint,
            RL_API_FALLBACK_ENDPOINT: apiConfig.fallbackEndpoint,
            SCHEMA_VERSION: apiConfig.schemaVersion,
            BUILD_ID: apiConfig.buildId,
            
            // Feature Flags
            ENABLE_MOCK_MODE: false,
            SKIP_API_VALIDATION: false,
            
            // Required Headers Configuration
            API_HEADERS: {
                'Content-Type': 'application/json',
                'x-api-key': apiConfig.apiKey,
                'X-Organization-ID': apiConfig.orgId,
                'X-Project-ID': apiConfig.projectId,
                'X-Assistant-ID': apiConfig.assistantId,
                'X-Source-Token': 'merit-chat',
                'X-Entry-Point': 'merit',
                'X-Source-URL': window.location.origin
            }
        };

        console.log('[Merit Flow] Build Information:', {
            buildId: window.env.BUILD_ID,
            schema: window.env.SCHEMA_VERSION,
            timestamp: BUILD_TIMESTAMP,
            environment: window.location.hostname
        });
    </script>

    <!-- Core Dependencies -->
    <script type="module" src="assets/js/client-merit-openai.js"></script>
    <script type="module" src="assets/js/client-merit-instructional-flow.js"></script>
</head>
<body>
    <div class="client-layout" data-client-component="merit-page" data-test-id="page-container">
        <aside class="merit-sidebar" data-test-id="merit-sidebar">
            <nav role="navigation" aria-label="Merit navigation">
                <a href="#welcome" class="active">Welcome</a>
                <a href="#chat">Chat</a>
            </nav>
        </aside>
        <button class="merit-sidebar-toggle" aria-label="Toggle navigation menu">
            <span class="visually-hidden">Menu</span>
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 12h18M3 6h18M3 18h18"/>
            </svg>
        </button>
        
        <main class="client-content" role="main" data-test-id="main-content">
            <div class="content-area" role="region" aria-label="Main content" data-test-id="content-area">
                <div class="section active" data-section="welcome" role="tabpanel" data-test-id="welcome-section">
                    <form class="welcome-form" id="welcome-form" data-test-id="welcome-form">
                        <select id="grade-level" class="form-control" required data-test-id="grade-select">
                            <option value="" disabled selected>Select a grade level</option>
                            <option value="Kindergarten">Kindergarten</option>
                            <option value="Grade 1">Grade 1</option>
                            <option value="Grade 2">Grade 2</option>
                            <option value="Grade 3">Grade 3</option>
                            <option value="Grade 4">Grade 4</option>
                            <option value="Grade 5">Grade 5</option>
                        </select>
                        <select id="curriculum" class="form-control" required data-test-id="curriculum-select">
                            <option value="ela" selected>English Language Arts (ELA)</option>
                        </select>
                    </form>
                </div>
                <div class="section" data-section="chat" role="tabpanel" hidden data-test-id="chat-section">
                    <div id="chat-window" class="chat-window" role="log" data-test-id="chat-window"></div>
                    <div id="chatbar" class="chatbar" hidden data-test-id="chatbar">
                        <textarea id="chat-input" class="chat-input" placeholder="Type your message..." data-test-id="chat-input"></textarea>
                        <button id="send-button" class="elpl-button" data-test-id="send-button">Send</button>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>
</html> 
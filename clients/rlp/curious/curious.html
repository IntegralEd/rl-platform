<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curious About Recursive Learning ?</title>
    <!-- Link to the specific Curious form styles -->
    <link rel="stylesheet" href="/clients/rlp/curious/assets/css/rl-curious.css">
    <!-- Link to existing Integral Ed styles (if still needed?) -->
    <!-- <link rel="stylesheet" href="/clients/integral-ed/assets/css/custom.css"> --> <!-- Commented out, likely redundant -->
    <!-- <link rel="icon" href="/clients/integral-ed/assets/images/logo.png" type="image/png"> --> <!-- Commented out, use RLP favicon? -->
    <link rel="icon" href="/shared/assets/images/recursive-learning-favicon.ico" type="image/x-icon"> <!-- Generic RL favicon -->
</head>
<body>
    <!-- Removed old inline styles -->
    <div class="rlp-form" id="curious-form-container">
        <!-- Header -->
        <div class="rlp-form__header">
            <h1 class="rlp-form__title">Curious About Recursive Learning?</h1>
            <p class="rlp-form__subtitle">Join the Friends & Family Beta</p>
        </div>

        <!-- Form Sections (managed by JS) -->
        <form id="curious-form">
            <div class="rlp-form__section" data-step="0">
                <legend class="rlp-form__legend">Welcome!</legend>
                <p class="rlp-form__helper">You weren't supposed to find us until 2026. We're hiding out in a friends and family beta. If you have a great use for this platform, fill out the info below. If you are aligned to our values and your needs match our early-release features, you may be invited to join our 2025 learning community.</p>
                <button type="button" class="rlp-form__button--next" onclick="showSection(1)">Next</button>
            </div>

            <div class="rlp-form__section" data-step="1" hidden>
                 <legend class="rlp-form__legend">Contact Info</legend>
                 <label for="signup-email" class="rlp-form__label">Email</label>
                 <p class="rlp-form__helper">We'll use this email to get in touch and to share preview access if you are approved for a beta account.</p>
                 <input type="email" id="signup-email" class="rlp-form__input" placeholder="Your Email" required oninput="validateForm()" />
                 <button type="button" class="rlp-form__button--next" onclick="showSection(2)">Next</button>
            </div>

            <div class="rlp-form__section" data-step="2" hidden>
                <legend class="rlp-form__legend">Context</legend>
                <label class="rlp-form__label">How did you learn about us?</label>
                <p class="rlp-form__helper"><em>Helper: Context-aware systems can handle traditional form field inputs...</em></p>
                <div class="rlp-form__checkbox-group">
                    <label class="rlp-form__label--checkbox"><input type="checkbox" name="source" value="friend"> Friend of Integral Ed</label>
                    <input type="text" class="rlp-form__input rlp-form__input--details" placeholder="Add detail" style="display: none;">
                    <label class="rlp-form__label--checkbox"><input type="checkbox" name="source" value="client"> Client of Integral Ed</label>
                    <input type="text" class="rlp-form__input rlp-form__input--details" placeholder="Add detail" style="display: none;">
                    <label class="rlp-form__label--checkbox"><input type="checkbox" name="source" value="alt_lms"> Seeking alternatives to traditional LMS</label>
                    <input type="text" class="rlp-form__input rlp-form__input--details" placeholder="Add detail" style="display: none;">
                    <label class="rlp-form__label--checkbox"><input type="checkbox" name="source" value="other"> Other</label>
                    <input type="text" id="intake-other-source" class="rlp-form__input rlp-form__input--details" placeholder="Describe here" style="display: none;">
                </div>
                <button type="button" class="rlp-form__button--next" onclick="showSection(3)">Next</button>
            </div>

            <div class="rlp-form__section" data-step="3" hidden>
                 <legend class="rlp-form__legend">Submit</legend>
                 <p class="rlp-form__helper">Ready to submit your interest?</p>
                 <button type="submit" id="submit-button" class="rlp-form__button--submit" disabled>Sign Up</button>
            </div>
        </form>
    </div>

    <script>
        let currentSection = 0;
        const sections = document.querySelectorAll('.rlp-form__section');
        const submitButton = document.getElementById('submit-button');
        const emailInput = document.getElementById('signup-email');
        const contextCheckboxes = document.querySelectorAll('input[name="source"]');

        function showSection(index) {
            // Basic validation before proceeding
            if (index > currentSection && !validateStep(currentSection)) {
                console.warn("Validation failed for step", currentSection);
                return; // Don't proceed if current step is invalid
            }
            
            sections.forEach((section, i) => {
                section.hidden = (i !== index);
            });
            currentSection = index;
            updateSubmitButtonState(); // Check if submit should be enabled
            console.log("Showing section", currentSection);
        }

        function validateStep(stepIndex) {
            switch(stepIndex) {
                case 0: // Welcome
                    return true; // No validation needed
                case 1: // Email
                    return emailInput && emailInput.checkValidity();
                case 2: // Context
                    // Check if at least one context checkbox is checked
                    return Array.from(contextCheckboxes).some(cb => cb.checked);
                default:
                    return true;
            }
        }

        function validateForm() {
            // This function enables/disables the final submit based on overall validity
            // We might need more robust validation later
            updateSubmitButtonState();
        }

        function updateSubmitButtonState() {
             // Enable submit only if email is valid and context has selection
             const emailValid = emailInput && emailInput.checkValidity();
             const contextValid = Array.from(contextCheckboxes).some(cb => cb.checked);
             if (submitButton) {
                 submitButton.disabled = !(emailValid && contextValid);
                 console.log("Submit button enabled:", !submitButton.disabled);
             }
        }
        
        // Basic handling for showing detail inputs on checkbox check
        contextCheckboxes.forEach(checkbox => {
            const detailInput = checkbox.closest('label').nextElementSibling;
            if (detailInput && detailInput.classList.contains('rlp-form__input--details')) {
                checkbox.addEventListener('change', () => {
                    detailInput.style.display = checkbox.checked ? 'block' : 'none';
                    if (!checkbox.checked) {
                        detailInput.value = ''; // Clear value if unchecked
                    }
                     updateSubmitButtonState(); // Re-validate on change
                });
            }
        });
        
        // Add event listener for form submission
        const form = document.getElementById('curious-form');
        if(form) {
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                if (!submitButton.disabled) {
                    signup();
                }
            });
        }

        function signup() {
            if (!submitButton.disabled) {
                console.log('Signing up...');
                const email = emailInput.value;
                const sources = Array.from(contextCheckboxes)
                                   .filter(cb => cb.checked)
                                   .map(cb => {
                                        const detail = cb.closest('label').nextElementSibling;
                                        return {
                                             value: cb.value, 
                                             detail: (detail && detail.style.display !== 'none') ? detail.value : null
                                        };
                                    });
                console.log("Signup Data:", { email, sources });
                // Add actual submission logic here (e.g., fetch API call)
                 alert("Thank you for your interest!");
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            showSection(0); // Start at the first section
        });
    </script>
</body>
</html>

<!-- 
  GoalSetter Welcome Form
  Original source: activities/goalsetter_welcome.html
  Moved to forms directory for consistency
  Usage: Include this form in GoalSetter welcome pages
-->

<div class="goalsetter-welcome" data-form="goalsetter">
  <h2>Welcome to GoalSetter</h2>
  <p class="welcome-text">Let's set some meaningful goals for your classroom.</p>
  
  <form id="goalsetter-form" class="goalsetter-form">
    <!-- Standards Alignment Section -->
    <div class="form-section">
      <h3>Standards Alignment</h3>
      <div class="radio-group">
        <label>
          <input type="radio" name="standards" value="yes" required>
          Yes, I want to align with standards
        </label>
        <label>
          <input type="radio" name="standards" value="no">
          No, I'll set goals independently
        </label>
      </div>

      <!-- Standards Details (shown when yes is selected) -->
      <div class="standards-details" data-show-when="standards" data-value="yes">
        <div class="form-field">
          <label for="standards-url">Standards URL</label>
          <input type="url" id="standards-url" name="standardsUrl" 
                 placeholder="https://example.com/standards">
        </div>
        <div class="form-field">
          <label for="standards-detail">Additional Context</label>
          <textarea id="standards-detail" name="standardsDetail" 
                    placeholder="Any additional context about these standards..."></textarea>
        </div>
      </div>
    </div>

    <!-- Previous Goals Section -->
    <div class="form-section">
      <h3>Previous Goals Review</h3>
      <div class="radio-group">
        <label>
          <input type="radio" name="reflection" value="yes" required>
          Yes, I want to reflect on previous goals
        </label>
        <label>
          <input type="radio" name="reflection" value="no">
          No, I'm starting fresh
        </label>
      </div>

      <!-- Reflection Details (shown when yes is selected) -->
      <div class="reflection-details" data-show-when="reflection" data-value="yes">
        <div class="form-field">
          <label for="reflection-input">Your Reflection</label>
          <textarea id="reflection-input" name="reflection" 
                    placeholder="What worked well? What would you change?"></textarea>
        </div>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="form-actions">
      <button type="submit" class="submit-button" disabled>
        Start Goal Setting
      </button>
    </div>
  </form>
</div>

<!-- 
  Styles moved to shared/admin/css/forms/goalsetter.css
  Original styles converted to CSS variables
-->
<style>
  .goalsetter-welcome {
    --form-max-width: 700px;
    --form-padding: 32px;
    --form-bg: var(--color-background);
    --form-text: var(--color-text);
    --form-border: var(--color-border);
    
    max-width: var(--form-max-width);
    margin: 0 auto;
    padding: var(--form-padding);
    background: var(--form-bg);
    color: var(--form-text);
  }

  .welcome-text {
    margin-bottom: 32px;
    font-size: 1.1em;
    color: var(--color-text-secondary);
  }

  .form-section {
    margin-bottom: 40px;
    padding: 24px;
    border: 1px solid var(--form-border);
    border-radius: 8px;
  }

  .radio-group {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 16px 0;
  }

  .radio-group label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
  }

  .form-field {
    margin: 16px 0;
  }

  .form-field label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
  }

  .form-field input,
  .form-field textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--form-border);
    border-radius: 4px;
    background: var(--color-background-light);
  }

  .form-field textarea {
    min-height: 100px;
    resize: vertical;
  }

  .standards-details,
  .reflection-details {
    display: none;
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--form-border);
  }

  .form-actions {
    margin-top: 32px;
    text-align: center;
  }

  .submit-button {
    --button-bg: var(--color-primary);
    --button-text: var(--color-text-light);
    
    background: var(--button-bg);
    color: var(--button-text);
    padding: 12px 32px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: opacity 0.2s;
  }

  .submit-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('goalsetter-form');
    const submitButton = form.querySelector('.submit-button');
    const radioGroups = form.querySelectorAll('.radio-group');
    const detailSections = form.querySelectorAll('[data-show-when]');

    // Show/hide detail sections based on radio selection
    function updateDetailSections() {
      detailSections.forEach(section => {
        const radioName = section.dataset.showWhen;
        const radioValue = section.dataset.value;
        const selectedRadio = form.querySelector(`input[name="${radioName}"]:checked`);
        
        section.style.display = selectedRadio?.value === radioValue ? 'block' : 'none';
      });
    }

    // Enable submit button when form is valid
    function updateSubmitButton() {
      const radios = form.querySelectorAll('input[type="radio"]');
      const requiredRadios = Array.from(radios).filter(radio => radio.required);
      const allRequiredChecked = requiredRadios.every(radio => 
        radio.checked || radio.closest('.radio-group').querySelector('input:checked')
      );
      
      submitButton.disabled = !allRequiredChecked;
    }

    // Add event listeners
    radioGroups.forEach(group => {
      group.addEventListener('change', () => {
        updateDetailSections();
        updateSubmitButton();
      });
    });

    // Handle form submission
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const formData = {
        standards: {
          choice: form.querySelector('input[name="standards"]:checked').value,
          url: form.querySelector('#standards-url')?.value,
          detail: form.querySelector('#standards-detail')?.value
        },
        reflection: {
          choice: form.querySelector('input[name="reflection"]:checked').value,
          text: form.querySelector('#reflection-input')?.value
        }
      };

      // Emit event for parent component
      document.dispatchEvent(new CustomEvent('goalsetterFormComplete', {
        detail: formData
      }));
    });

    // Initial state
    updateDetailSections();
    updateSubmitButton();
  });
</script> 
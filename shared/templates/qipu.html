<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Arial; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Arial; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;title&gt;Qipu MVP Annotation Tool&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>body, html {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>overflow-x: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-family: Arial, sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#main-content {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: 1200px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>height: 900px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background-color: #ddd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 0 auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>position: relative;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#paintbrush {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>position: fixed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>bottom: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>right: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: 50px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>height: 50px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background-color: tan;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-radius: 50%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size: 24px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>user-select: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>z-index: 1000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#annotation-tray {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>position: fixed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>bottom: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>left: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>height: 80px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background-color: #f7f7f7;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>box-shadow: 0 -2px 5px rgba(0,0,0,0.3);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>transform: translateY(100%);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>transition: transform 0.5s ease-in-out;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gap: 30px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>z-index: 999;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.tool {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>height: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-radius: 50%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background-color: #555;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #fff;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>transition: transform 0.2s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>user-select: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.tool:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>transform: scale(1.3);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#annotationCanvasContainer {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>position: fixed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>top: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>left: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>height: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background-color: rgba(0,0,0,0.5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>display: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>z-index: 998;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#annotationCanvas {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border: 2px solid #333;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#submitComment {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>position: absolute;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>bottom: 90px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>right: 30px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding: 8px 16px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div id="main-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>Main Learning Content (1200 x 900)</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div id="paintbrush"&gt;🖌️&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div id="annotation-tray"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="tool" id="drawTool"&gt;✏️&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="tool" id="textTool"&gt;🔤&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="tool" id="eraseTool"&gt;🧽&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="tool" id="commentTool"&gt;💬&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div id="annotationCanvasContainer"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;canvas id="annotationCanvas"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;button id="submitComment"&gt;Submit Comment&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const paintbrush = document.getElementById('paintbrush');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const tray = document.getElementById('annotation-tray');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const canvasContainer = document.getElementById('annotationCanvasContainer');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const canvasElem = document.getElementById('annotationCanvas');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const submitBtn = document.getElementById('submitComment');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>let canvas;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>paintbrush.onclick = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tray.style.transform = 'translateY(0)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>document.getElementById('drawTool').onclick = startAnnotation;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>document.getElementById('textTool').onclick = startAnnotation;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>document.getElementById('eraseTool').onclick = () =&gt; canvas.clear();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>document.getElementById('commentTool').onclick = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const comment = prompt('Enter your comment:');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (comment) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>canvas.add(new fabric.Textbox(comment, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>left: 50, top: 50, width: 200, fontSize:16</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>async function startAnnotation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tray.style.transform = 'translateY(100%)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>canvasContainer.style.display = 'flex';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenshot = await html2canvas(document.body);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>canvasElem.width = screenshot.width / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>canvasElem.height = screenshot.height / 2;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>canvas = new fabric.Canvas('annotationCanvas', { isDrawingMode: true });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>fabric.Image.fromURL(screenshot.toDataURL(), img =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>img.scale(0.5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>submitBtn.onclick = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const data = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>thread_id: window.location.href + '#' + Date.now(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>url: window.location.href,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>timestamp: Date.now(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>user_id: 'user_uuid',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>annotations: canvas.getObjects().map(obj =&gt; ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>type: obj.type,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>content: obj.toDataURL ? obj.toDataURL() : obj.text,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>xy_position: { x: obj.left, y: obj.top }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>})),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>created_at: new Date().toISOString()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>fetch('https://your-ticketing-system.com/api/submit', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>headers: { 'Content-Type': 'application/json' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>body: JSON.stringify(data)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.then(res =&gt; res.json())</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.then(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>canvasContainer.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>canvas.clear();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>alert('Comment submitted!');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.catch(() =&gt; alert('Submission failed.'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
